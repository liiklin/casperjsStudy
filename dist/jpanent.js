// Generated by CoffeeScript 1.10.0
(function() {
  var casper;

  casper = require("casper").create({
    verbose: true,
    logLevel: 'debug',
    waitTimeout: 60 * 1000,
    pageSettings: {
      loadImages: false,
      loadPlugins: false,
      userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36'
    }
  });

  casper.start("https://www4.j-platpat.inpit.go.jp/eng/tokujitsu/tkbs_en/TKBS_EN_GM101_Top.action", function() {
    this.echo(this.getTitle());
    this.fill('form[id="searchForm"]', {
      "bTmFCOMDTO.InputDocNumList[0]": "2003-179582"
    }, false);
    this.capture("1.jpg");
    return this.click("input[id='button_searchresult']");
  });

  casper.waitForSelector("a#unexPubLink0", function() {
    this.capture("2.jpg");
    return this.click("a#unexPubLink0");
  });

  casper.waitForSelector("#resultForm > div.contents > div > div.grid > iframe", function() {
    var url;
    this.capture("3.jpg");
    url = this.evaluate(function() {
      return $('#resultForm > div.contents > div > div.grid > iframe').attr("src");
    });
    return this.open(url);
  });

  casper.waitForSelector("body > form", function() {
    this.capture("4.jpg");
    return this.fill("form[name='KeikaLink']", {}, true);
  });

  casper.waitForPopup("www1", function() {
    this.capture("5.jpg");
    return this.echo(this.getCurrentUrl());
  });

  casper.withPopup("www1", function() {
    var datas;
    this.capture("6.jpg");
    this.echo(this.getCurrentUrl());
    datas = this.evaluate(function() {
      var formdata;
      formdata = [];
      $("table tr").each(function() {
        var tmp;
        tmp = {};
        tmp[$(this).find("th").text()] = $(this).find("td").text();
        formdata.push(tmp);
      });
      return formdata;
    });
    return this.echo(JSON.stringify(datas));
  });

  casper.run(function() {
    return this.exit();
  });

}).call(this);

//# sourceMappingURL=jpanent.js.map
